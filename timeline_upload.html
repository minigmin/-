<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="timeline_style.css" />
    <link
      rel="stylesheet"
      as="style"
      crossorigin
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css"
    />
</head>
<body>
    <div class="header">
        <a class="back-icon" href=""></a>
        <h1>타임라인 업로드</h1>
        <a class="" href=""></a>
    </div>

    <div class="uploadbox">
        <div class="boxA" id="boxA">
            <div class="upload-img"></div>
            <h1>사진 업로드하기</h1>
        </div>
        <div class="boxB" id="boxB"></div>
    </div>

    <div class="contents">
        <div class="check A">
            <div class="checklist A">
                <span class="check-icon"></span>
                <h1>제목</h1>
            </div>
            <div class="inputbox">
                <textarea id="auto-grow" data-limit="30" placeholder="제목을 입력해주세요."></textarea>
                <div class="counter">최대 글자수 <span id="char-count">0</span>/30</div>
            </div>
        </div>

        <div class="check B">
            <div class="checklist B">
                <span class="check-icon"></span>
                <h1>내용</h1>
            </div>
            <div class="inputbox">
                <textarea id="auto-grow" data-limit="100" placeholder="내용을 입력해주세요."></textarea>
                <div class="counter">최대 글자수 <span id="char-count">0</span>/100</div>
            </div>
        </div>

        <div class="check C">
            <div class="checklist C">
                <span class="check-icon"></span>
                <h1>함께한 사람</h1>
            </div>
            <div class="plus-bt" id="addPerson">
                <div class="avatars" id="avatars"></div>
                <span class="plus-icon"></span>
                <h1>인원추가</h1>
            </div>
        </div>
    </div>
    <div class="nextBT" role="button" tabindex="0">
        <h1>업로드</h1>
    </div>







 <script>
  document.addEventListener('DOMContentLoaded', () => {
    const BASE  = 65;
    const boxA  = document.getElementById('boxA');
    const boxB  = document.getElementById('boxB');
    const nextBT = document.querySelector('.nextBT');

    // CSS 변수 값을 실제 색상값으로 읽기
    const css = getComputedStyle(document.documentElement);
    const MAIN = css.getPropertyValue('--main-color').trim();
    const NONE = css.getPropertyValue('--none').trim();

    // 조건 검사
    function checkConditions() {
      const titleTA   = document.querySelector('.check.A textarea');
      const contentTA = document.querySelector('.check.B textarea');

      const hasPhoto   = boxA.classList.contains('filled') || boxB.classList.contains('filled');
      const hasTitle   = titleTA && titleTA.value.trim().length > 0;
      const hasContent = contentTA && contentTA.value.trim().length > 0;

      return hasPhoto && hasTitle && hasContent;
    }

    // 업로드 버튼 상태 갱신(색 + 커서 클래스)
    function updateUploadButton() {
      const ok = checkConditions();
      nextBT.style.backgroundColor = ok ? MAIN : NONE;
      nextBT.classList.toggle('active', ok);   // CSS의 cursor 변경용
      nextBT.setAttribute('aria-disabled', ok ? 'false' : 'true');
    }

    // textarea 자동높이 + 카운트 + 버튼 갱신
    document.querySelectorAll('.inputbox').forEach(box => {
      const ta = box.querySelector('textarea');
      const countEl = box.querySelector('.char-count, #char-count');
      if (!ta || !countEl) return;

      const LIMIT = parseInt(ta.getAttribute('data-limit'), 10) || 30;

      const update = () => {
        ta.style.height = BASE + 'px';
        if (ta.scrollHeight > BASE) ta.style.height = ta.scrollHeight + 'px';

        const len = ta.value.length;
        countEl.textContent = len;
        countEl.style.color = (len > LIMIT) ? MAIN : '';

        updateUploadButton();
      };

      update();
      ta.addEventListener('input', update);
    });

    // 이미지 업로드(클릭 시 배경 교체 + filled 마킹)
    boxA.addEventListener('click', () => {
      boxA.style.backgroundImage = "url('../이미지/타임라인1.png')";
      const icon = boxA.querySelector('.upload-img');
      const text = boxA.querySelector('h1');
      if (icon) icon.style.display = 'none';
      if (text) text.style.display = 'none';
      boxA.classList.add('filled');
      updateUploadButton();
    });

    boxB.addEventListener('click', () => {
      boxB.style.backgroundImage = "url('../이미지/아이템4.png')";
      const icon = boxB.querySelector('.upload-img');
      const text = boxB.querySelector('h1');
      if (icon) icon.style.display = 'none';
      if (text) text.style.display = 'none';
      boxB.classList.add('filled');
      updateUploadButton();
    });

    // 업로드 버튼 클릭: 조건 만족 시에만 이동
    nextBT.addEventListener('click', () => {
      if (checkConditions()) {
        window.location.href = 'index.html';
      } else {
        // 비활성 상태에서 클릭해도 아무 동작 없음 (원하면 alert로 바꿔도 됨)
      }
    });

    // 초기 상태 한 번 적용
    updateUploadButton();
  });
</script>
</body>
</html>